# **Spreadsheet**
## **Описание**
_Spreadsheet_ - упрощенный аналог существующих решений: лист таблицы _Microsoft_ Excel или _Google Sheets_. Лист электронной таблицы состоит из ячеек с данными. Они могут содержать в себе текст или формулы, включая ссылки на другие ячейки таблицы. С ячейками разных типов можно совершать различные операции.
## **Функционал**
* метод _SetSell_ - задание содержимого ячейки по индексу, если ячейка была пустой - она создается;
* метод _GetSell_ - получение указателя на ячейку по ее индексу, если ячейка пуста - возвращается nullptr;
* метод _ClearCell_ - очистка ячейки по индексу. Последующий вызов _GetCell_ для этой чейки вернет nullptr;
* метод _GetPrintableSize_ - получение размера минимальной печатной области таблицы;
* метод _PrintText_ - выводит текстовое представление ячеек;
* метод _PrintValue_ - выводит значения ячеек.
## **Сборка и запуск**
1) Установить [_Java SE Runtime Environment 8_](https://www.oracle.com/java/technologies/downloads/#java8) (необходим для работы с ANTLR) и библиотеку для работы с ним.
2) Установить [_ANTLR_](https://www.antlr.org/download.html) (ANother Tool for Language Recognition).
3) Сгенерировать файлы лексического и синтаксического анализаторов.
4) Собрать проект _Spreadsheet_ с помощью _CMake_.
## **Работа с проектом**
### **Ячейка (Cell)**
Класс `Cell` - ячейка. Пользователь имеет доступ к ячейке по индексу, который задается строкой вида `"A1"`, `"C15"` или `"ABC123"`. Если индекс ячейки задается некорректно - программа выбрасывает исключение `InvalidPositionException`. Пользователь может задать ячейке некий текст, в зависимости от содержания программа определяет его по-разному. В представленной реализации ячейка может содержать только два типа данных: текст или формула:
* Ячейка считается формульной, если её текст начинается со знака `"="`, все, что следует после него, является выражением формулы, пробелы перед знаком `"="` не игнорируются.
* Все остальные ячейка трактуются как текстовые.

Тип существующей ячейки может меняться, если пользователь задал в ней новый текст. Для всех типов ячеек существует два представления: текст ("сырое" представление) и значение. Если в ячейке задается неверная формула - выбрасывается исключение `FormulaException`, формула, приводящая к ошибке вычисления, не считается некорректной, текст, содержащий только знак `"="`, формулой не считается. Если формула содержит индекс пустой ячейки, предполагается, что её значение равно 0. При попытке задать формулу, содержащую циклическую зависимость, программа выбрасывает исключение `CircularDependencyException`, а значение в ячейке не изменяется. 
### **Таблица (Sheet)**
Для взаимодействия с таблицей необходимо создать экземпляр класса _Sheet_. Таблица содержит набор ячеек, методы для работы с ней представлены в разделе **Функционал**, условно их можно разделить на две группы:
* Методы, обращения к ячейке по индексу (`SetSell`, `GetSell`, `ClearCell`);
* Методы, применимые к таблице целиком (`GetPrintableSize`, `PrintText`, `PrintValue`).

Ниже приведен пример кода c организующего работу с таблицей.
```
auto sheet = CreateSheet();
sheet->SetCell("A1"_pos, "1");
sheet->SetCell("A2"_pos, "=A1");
sheet->SetCell("B2"_pos, "=A1");
sheet->ClearCell("B2"_pos);
sheet->PrintValues(std::cout);
```
## **Тестирование**
Весь представленный функционал проекта покрыт модульными тестами (тесты расположены в файле main.cpp).
## **Технологии**
* Для парсинга формул используется дерево разбора (утилита _ANTLR_). Правила грамматики заданы в файле с расширением _.g4_.
* Формулы представляются в виде _AST_ (Abstract syntax tree). Это позволяет удобно вычислять их значения с помощью рекурсии. В код, отвечающий за _AST_, добавлена возможность производить вычисления.
## **Требования**
Компилятор С++ с поддержкой стандарта C++17 или новее.
Antlr-4.13.0 (Версия antlr-4.13.0-complete.jar может отличаться).
